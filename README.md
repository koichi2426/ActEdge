# ActEdge – 現状把握リアルタイム推論エンジン

ユーザーの環境・ペルソナ・発言から、**今この瞬間に最も適した行動（または介入しないという選択）** をリアルタイムに判断する、モバイル・組み込み対応の軽量推論エンジン。

---

## ■ 目的

本エンジンは、ユーザーの **環境情報**、**ペルソナ情報**、および **発言情報（未発話も含む）** をもとに、与えられた候補メソッド群から、**「今この瞬間に最も適した行動、または何もしない（NoAction）」** を選択します。

推論結果が「何もしない（NoAction）」であっても、それは状況が安定しており、ユーザーに最適な介入が不要であると判断された結果です。
モバイル・組み込み環境での即時動作と、**過干渉を避ける設計**を重視しています。

---

## ■ 入出力仕様

| 種類  | 内容例                                                                                |
| --- | ---------------------------------------------------------------------------------- |
| 入力① | 環境情報：時間帯、場所、周囲音、照明、温湿度、使用中のデバイスなど                                                  |
| 入力② | ペルソナ情報：年齢、性格、生活習慣、疲労度、目的、嗜好など                                                      |
| 入力③ | 発言情報（省略可）：自然言語の発話・入力（例：「ちょっと一息つきたい」）                                               |
| 入力④ | 候補メソッド群：RelaxMusic, SuggestBreak, NotifyHydration, LaunchFocusApp, **NoAction** など(未知メソッド) |
| 出力  | 最適なメソッド（1つ、例：`SuggestBreak` または `NoAction`）とその理由（スコア・根拠付き）                         |

### 入力仕様
![image](https://github.com/user-attachments/assets/8a5092a5-11b3-4ec2-9d3a-b7c83e918ef3)

```json
{
  "environment": {
    "time_of_day": "午後",
    "location": "オフィス",
    "ambient_sound": "静穏",
    "lighting": "暖色",
    "temperature": "25°C",
    "humidity": "40%",
    "device_in_use": "スマートフォン"
  },
  "persona": {
    "age": 30,
    "personality": "外向的",
    "lifestyle": "忙しい",
    "fatigue_level": "中程度",
    "purpose": "集中作業",
    "preferences": ["音楽", "静かな空間"]
  },
  "utterance": {
    "text": "ちょっと一息つきたい",
    "language": "日本語"
  },
  "candidate_methods": [
    "RelaxMusic",
    "SuggestBreak",
    "NotifyHydration",
    "LaunchFocusApp",
    "NoAction"
  ]
}
```

### 出力仕様
```json
{
  "selected_method": "SuggestBreak",
  "reason": {
    "score": 85,
    "explanation": "ユーザーが一息つきたいという発言と疲労度から、休憩を提案するのが最適と判断された。"
  }
}
```
---

## ■ コア処理構造（Decision Engine）

### 1. 特徴量抽出層（Feature Extraction Layer）

特徴量抽出層では、環境・ペルソナ・発言情報をもとに、**明示的な前処理（正規化・エンコーディング）および埋め込み表現・軽量NNによる自動特徴抽出を併用**し、モデルに適した統合ベクトルを生成する。

* 環境・ペルソナ情報：正規化、カテゴリ変換、ワンホット or 埋め込みベクトル
* 発言情報（あれば）：文脈埋め込み（例：Sentence-BERT、fastText など）
* 発言がない場合はゼロ埋めやマスク処理で対応

---

### 2. 条件照合層（Rule-based Filter）

* 実行不可能・不適切なメソッドをルールベースで事前除外

  * 例：「外出中は照明操作不可」「深夜の通知は禁止」など、状況依存の実行制約ルールを適用

---

### 3. 行動予測層（Contextual Intent Estimation）

* 特徴ベクトル全体（環境・ペルソナ・発言含む）をもとに、以下を予測

  * 行動が必要か／NoActionが適切か（二値分類）
  * 想定される行動意図（Intent）や緊急度（Urgency）（任意）
* 使用手法：SVM、RandomForest、軽量NN、ルール併用など

---

### 4. 適合度評価層（Method-Intent Matching）

* 候補メソッド（含むNoAction）と、予測された意図・状況との適合度を評価

  * 手法：コサイン類似度・ルール・距離計算などを用途に応じて組み合わせ

---

### 5. スコア統合層（Multi-Factor Scoring）

* 複数の評価軸に基づき、最終スコアを算出し、最も適切なメソッドを選択

| 指標                     | 内容                     |
| ---------------------- | ---------------------- |
| 満足度（Utility）           | 行動によって期待される快適性・有益性     |
| 緊急度（Urgency）           | 今すぐ対応すべき必要性の高さ         |
| 干渉度（Interruption Risk） | 現在の活動をどれだけ妨げるか         |
| 実行コスト                  | 時間・エネルギー・認知負荷などのリソース負担 |
| 無干渉適合度                 | 何もしない（NoAction）選択の妥当性  |

---

## ■ 特徴と強み

* ✅ **過干渉抑制**：状況が安定していれば介入せずNoActionを推奨
* ✅ **常時推論型**：発言がなくても状態変化に応じて常に判断を実行
* ✅ **説明可能性**：選択／非選択の理由をスコア・ルールで提示
* ✅ **軽量実装**：SVMや木構造により省メモリ・高速推論
* ✅ **高拡張性**：新メソッド／新ルール／スコア軸の追加が容易

---

## ■ ユースケース例

| 状況         | 発言           | 推奨メソッド                     |
| ---------- | ------------ | -------------------------- |
| 午後＋静穏＋集中状態 | （発言なし）       | `NoAction`（干渉せず維持）         |
| 深夜＋疲労＋静寂   | 「今日はもう無理かも…」 | `SuggestBreak`             |
| 夏＋高温＋屋内    | （発言なし）       | `NotifyHydration`（環境リスク検知） |
| 通勤中＋雑音環境   | 「静かにしてほしいな…」 | `PlayCalmMusic`            |

---

## ■ データ仕様と学習方針

* **履歴件数**：3,000〜10,000件（状況・発言・メソッド含む）
* **特徴量**：

  * 環境（10項目）、ペルソナ（10項目）、発言エンベディング（任意）
* **手法**：

  * SVM、RandomForest、LightNN、小規模NN＋ルール合成

---

## ■ ライセンス

MIT License（[LICENSE](https://opensource.org/license/mit)）

---

## ■ 開発者

* 作成者: 佐藤 幸一
* GitHub: [github.com/koichi2426](https://github.com/koichi2426)
* 連絡先: [satoyskkh200426@gmail.com](mailto:satoyskkh200426@gmail.com)
